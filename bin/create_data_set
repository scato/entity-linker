#!/usr/bin/env python3

import sys;


sys.path.append('src')


from entity_linker.data.file import download_wikipedia_file
from entity_linker.data.xml import read_redirects
from entity_linker.data.xml import read_pages
from entity_linker.data.wiki import write_features
from itertools import islice


# FILENAME = 'enwiki-latest-pages-articles.xml.bz2'
FILENAME = 'enwiki-latest-pages-articles1.xml-p10p30302.bz2'

print('Downloading XML...')
download_wikipedia_file(FILENAME)

print('Extracting features...')
redirects = read_redirects(FILENAME)
pages = read_pages(FILENAME)
pages = islice(pages, 100)
write_features(pages, redirects)
